<% content_for :header do %>
    <%= @repository.title %>
<% end %>

<%= render 'layouts/notifications.html.erb' %>

<% if not @repository.description.blank? %>
  <p class="description">
    <%= @repository.description %>
  </p>
<% end %>

<p>
  <strong>Created:</strong>
  <%= @repository.created_at.to_s(:siso_date) %>
</p>

<p>
  <strong>Deleted:</strong>
  <%= @repository.deleted_at.to_s(:siso_date) %>
</p>

<table>
  <thead>
    <tr>
      <th>File name</th>
      <th>Size</th>
      <th>Creation Time</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
  <% if @records.length == 0 %>
    <tr>
      <td>No records</td><td colspan="3"></td>
    </tr>
  <% else %>
    <% @records.each do |record| %>
      <tr>
        <td>
          <%= link_to record.file_name, {controller: :records, action: :show, id: @repository.token, record_id: record.token}, {class: 'filename'} %>
        </td>
        <td class="center"><%= human_readable_bytes(record.size) %></td>
        <td class="center"><%= record.created_at.to_s(:date_time) %></td>
        <td class="right"><%= button_to('Delete', {controller: :records, action: :delete, id: @repository.token, record_id: record.token}, method: 'delete')%></td>
      </tr>
    <% end %>
  <% end %>
  </tbody>
</table>


<h3>File Upload</h3>
<%= form_tag({controller: :records, action: :create}, method: :put, multipart: true) do %>
    <%= file_field_tag 'file' %><%= submit_tag 'Upload' %>
<% end %>

<% content_for :info do %>
<div id="info">
  <%= button_to('Delete Repository', {controller: :repositories, action: :delete, id: @repository.token},
                data: { confirm: 'Are you sure you want to delete this repository? All files will be deleted.' }, method: 'delete', form_class: 'delete, float_right', id: 'delete_btn')%>
  <%= button_to('Audit log', {controller: :repositories, action: :audit, id: @repository.token},
                method: 'get', form_class: 'right')%>
  <div id="clear"></div>
</div>
<% end %>